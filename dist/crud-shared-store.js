import{h as e,T as t,r as s,e as i,n as a}from"./property-87bb8bd7.js";import{c as r}from"./repeat-bd309a28.js";class n extends EventTarget{constructor(){super(),this.names=[]}filterSurname(e){if(!e)return this.names;const t=this.names.filter((t=>!!t.surname.toUpperCase().includes(e.toUpperCase())));return this._dispatch("read"),t}get(e){return this.names.find((t=>t.id==e))}getId(e){const t=this.names.find((t=>t.firstName==e.firstName&&t.surname==e.surname));if(t)return t.id}has(e){return this.names.filter((t=>t.id==e)).length>0}_getUID(){return`${Date.now().toString()}-${Math.floor(1e6*Math.random())}`}create(e){const t={...e,id:this._getUID()};this.names.push(t),this._dispatch("create")}update(e){this.has(e.id)&&this.delete(e.id),this.create(e),this._dispatch("update")}delete(e){this.names=this.names.filter((t=>t.id!==e)),this._dispatch("delete")}_dispatch(e){return this.dispatchEvent(new CustomEvent(e,{detail:{eventName:e},cancelable:!0}))}}const l=new n;class o{constructor(e,t){(this.host=e).addController(this),this.store=l,this.ops=t}hostConnected(){this.ops.forEach(((e,t)=>{this.store.addEventListener(t,e)}))}hostDisconnected(){this.ops.forEach(((e,t)=>{this.store.removeEventListener(t,e)}))}}var h=function(e,t,s,i){var a,r=arguments.length,n=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,i);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(n=(r<3?a(n):r>3?a(t,s,n):a(t,s))||n);return r>3&&n&&Object.defineProperty(t,s,n),n};let c=class extends e{constructor(){super(),this._filter="",this._firstName="",this._surname="",this._displayNames=[];const e=new Map;e.set("create",this._doUpdate.bind(this)),e.set("read",this._doUpdate.bind(this)),e.set("delete",this._doUpdate.bind(this)),e.set("update",this._doUpdate.bind(this)),this.crudController=new o(this,e),this.crudController.store.create({firstName:`Hans-${(100*Math.random()).toFixed(0)}`,surname:"Emil"}),this.crudController.store.create({firstName:`Max-${(100*Math.random()).toFixed(0)}`,surname:"Mustermann"}),this.crudController.store.create({firstName:`Roman-${(100*Math.random()).toFixed(0)}`,surname:"Tisch"}),this._updateDisplayList()}_sortDisplayNames(){this._displayNames=this._displayNames.sort(((e,t)=>e.surname.localeCompare(t.surname)))}_doUpdate(e){e&&e.target&&(console.log(`Store event ${e.type}`),this._updateDisplayList(),this.requestUpdate())}_changeFilterString(e){e&&e.target&&(this._filter=e.target.value,this._updateDisplayList())}_clickCreate(){this.crudController.store.create({firstName:this._firstName,surname:this._surname}),this._updateDisplayList()}_clickUpdate(){this._selectedName?this.crudController.store.update({id:this._selectedName.id,firstName:this._firstName,surname:this._surname}):this.crudController.store.create({firstName:this._firstName,surname:this._surname}),this._updateDisplayList()}_clickDelete(){this._selectedName&&this.crudController.store.delete(this._selectedName.id),this._updateDisplayList()}_updateDisplayList(){this._displayNames=this.crudController.store.filterSurname(this._filter),this._sortDisplayNames()}_selectName(e){if(!e||!e.target)return;const t=e.target.value,s=this.crudController.store.get(t);s&&(this._selectedName=s,this._firstName=s.firstName,this._surname=s.surname)}_changeFirstName(e){e&&e.target&&(this._firstName=e.target.value)}_changeSurname(e){e&&e.target&&(this._surname=e.target.value)}render(){return t`<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.2/css/bulma.min.css"><div class="box"><label class="is-size-5" for="filter">Filter Surname:</label> <input type="search" id="filter" name="filter" class="input" .value="${this._filter}" @input="${this._changeFilterString}"><br><label class="is-size-5" for="name-select">Choose a Name:</label> <select name="name-select" id="name-select" size="5" @change="${this._selectName}">${r(this._displayNames,(e=>e.surname),(e=>t`<option value="${e.id}">${e.surname}, ${e.firstName}</option>`))}</select><br><label class="is-size-5" for="first-name">First Name</label> <input type="text" id="first-name" name="first-name" class="input" .value="${this._firstName}" @input="${this._changeFirstName}"><br><label class="is-size-5" for="surname">Surname</label> <input type="text" id="surname" name="surname" class="input" .value="${this._surname}" @input="${this._changeSurname}"><br><button class="button" @click="${this._clickCreate}">Create</button> <button class="button" @click="${this._clickUpdate}">Update</button> <button class="button" @click="${this._clickDelete}">Delete</button></div>`}};c.styles=s`.invalid{background:coral}`,h([i()],c.prototype,"_filter",void 0),h([i()],c.prototype,"_firstName",void 0),h([i()],c.prototype,"_surname",void 0),h([i()],c.prototype,"_displayNames",void 0),c=h([a("seven-gui-crud-shared-store")],c);export{c as CRUD};
